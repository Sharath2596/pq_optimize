Sub ToggleRibbonAndTabs()
    ' Toggle Ribbon
    Dim ribbonVisible As Boolean
    Static ribbonState As Boolean

    ' We'll use the sheet tab visibility as a proxy since Ribbon visibility isn't directly readable
    ribbonVisible = ActiveWindow.DisplayWorkbookTabs

    If ribbonVisible Then
        ' Hide both
        Application.ExecuteExcel4Macro "SHOW.TOOLBAR(""Ribbon"", False)"
        ActiveWindow.DisplayWorkbookTabs = False
        ribbonState = False
    Else
        ' Show both
        Application.ExecuteExcel4Macro "SHOW.TOOLBAR(""Ribbon"", True)"
        ActiveWindow.DisplayWorkbookTabs = True
        ribbonState = True
    End If
End Sub
